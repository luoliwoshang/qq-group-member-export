# QQ群成员导出工具

一个简单易用的浏览器脚本，用于导出QQ群成员信息到CSV文件。

## 功能特性

- 📊 一键导出QQ群成员数据到CSV文件
- 🎨 炫酷的渐变UI设计
- 🚀 简单易用，只需在浏览器控制台粘贴代码
- 💾 导出数据：QQ号、群昵称（无群昵称时留空）
- ✨ 支持中文字符（UTF-8 BOM编码）
- 🎯 自动处理多tbody结构（懒加载数据）
- 🔔 友好的通知提示

## 使用方法

### 步骤1：打开QQ群成员页面

访问QQ群成员管理页面：
```
https://qun.qq.com/member.html#gid=你的群号
```

登录后，等待页面加载完所有群成员数据（向下滚动加载全部成员）。

### 步骤2：打开浏览器控制台

- **Windows/Linux**: 按 `F12` 或 `Ctrl + Shift + I`
- **Mac**: 按 `Cmd + Option + I`

### 步骤3：粘贴并执行脚本

1. 打开 `export-qq-members.js` 文件
2. 复制全部代码
3. 在控制台中粘贴代码
4. 按 `Enter` 执行

### 步骤4：导出数据

执行脚本后，页面右上角会出现：
- 🎨 **导出群成员** 按钮（紫色渐变，带动画效果）
- 🐙 **GitHub链接** （点击访问作者主页）

点击"导出群成员"按钮，即可下载CSV文件。

## 导出数据格式

CSV文件包含以下字段：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| QQ号 | 成员的QQ号码 | 123456789 |
| 群昵称 | 成员的群名片 | 技术部-张三 |

### CSV文件示例

```csv
QQ号,群昵称
123456789,技术部-张三
987654321,市场部-李四
555666777,
111222333,运营部-王五
```

## 技术特点

### 1. 多tbody处理

QQ群成员页面使用多个`<tbody>`分段加载数据，脚本会自动遍历所有tbody区块：

```javascript
const tbodies = table.querySelectorAll('tbody');
tbodies.forEach(tbody => {
  // 处理每个tbody中的数据行
});
```

### 2. 表头过滤

自动跳过包含`<th>`元素的表头行：

```javascript
if (row.querySelector('th')) return;
```

### 3. 数据提取

- **QQ号**: 从第5列（index=4）提取
- **群昵称**: 从第4列（index=3）的`.group-card`元素提取

### 4. CSV编码

添加UTF-8 BOM以确保Excel正确显示中文：

```javascript
csvRows.push('\uFEFF');
```

### 5. 特殊字符处理

- 自动处理群昵称中的逗号（使用双引号包裹）
- 替换HTML实体（如`&nbsp;`）
- 合并多余空格

## UI效果

### 导出按钮
- 渐变背景色（紫色系）
- 悬停时上浮2px
- 点击时显示"导出中..."状态
- 柔和的阴影效果
- 背景渐变动画

### 通知提示
- 右上角滑入动画
- 半透明模糊背景
- 3秒后自动消失
- 成功/信息两种样式

### GitHub链接
- GitHub图标 + 作者名
- 悬停时放大旋转
- 深色渐变背景

## 浏览器兼容性

- ✅ Chrome 90+
- ✅ Edge 90+
- ✅ Firefox 88+
- ✅ Safari 14+

## 注意事项

1. **加载全部数据**: 导出前请确保页面已加载所有群成员（向下滚动至底部）
2. **重复执行**: 脚本包含防重复加载检测，多次执行不会重复添加按钮
3. **权限要求**: 需要有查看群成员的权限（群主/管理员/普通成员）
4. **数据隐私**: 所有数据处理均在本地浏览器中完成，不会上传到任何服务器

## 开发文档

详细的页面结构分析请参考：
- [QQ群成员页面结构分析.md](./QQ群成员页面结构分析.md)

## 更新日志

### v1.0.0 (2025-10-15)
- 🎉 初始版本发布
- ✨ 实现基本导出功能（QQ号、群昵称）
- 🎨 添加炫酷UI设计
- 📝 添加使用文档

## 作者

**luoliwoshang**

- GitHub: [@luoliwoshang](https://github.com/luoliwoshang)

## 许可证

MIT License

---

⭐ 如果这个工具对你有帮助，欢迎 Star！
